# Notion 2nd Brain Setup Guide for Frontline Holdings
## Source of Truth — Invoice, Payment & Project Tracking

> **Applies to:** Proposal Option 2 (Gap-Filler + 2nd Brain) and Option 3 (Full Replacement) only.
> Option 1 (Gap-Filler) does not include Notion — skip this guide if Option 1 is selected.
> See `PROPOSAL-FRONTLINE-PAYMENT-AUTOMATION.md` for option details and pricing.

---

## Overview

This guide walks through setting up Notion as Frontline Holdings' **"2nd Brain"** — a single source of truth that aggregates data from Procore, QuickBooks Online, and SmoothX into one unified operational dashboard.

The architecture follows the **PARA Method** (Projects, Areas, Resources, Archives) from Tiago Forte's "Building a Second Brain" methodology, adapted for construction company operations.

---

## Workspace Structure (PARA)

```
Frontline Holdings Workspace
├── Projects (Active with deadlines)
│   ├── [Project Name] - Each active construction project
│   └── Links to: Invoices, Commitments, Change Orders
├── Areas (Ongoing responsibilities)
│   ├── Finance & Payments
│   ├── Subcontractor Management
│   ├── Safety & Compliance
│   └── Client Relations
├── Resources (Reference material)
│   ├── Vendor Directory
│   ├── Contract Templates
│   ├── Building Codes & Regulations
│   └── System Integration Docs
└── Archives (Completed/inactive)
    ├── Closed-out Projects
    └── Historical Records
```

---

## Database 1: Invoice Tracker (Master Database)

This is the **most critical database** — the central ledger that prevents duplicate payments.

### Properties

| Property Name | Type | Description | Required |
|--------------|------|-------------|----------|
| Invoice ID | Title | Invoice number (e.g., "INV-2024-0042") | Yes |
| Fingerprint | Text | SHA256 dedup hash (auto-generated by n8n) | Yes |
| Vendor | Relation → Vendors DB | Who submitted the invoice | Yes |
| Amount | Number (USD) | Invoice total | Yes |
| Invoice Date | Date | Date on invoice | Yes |
| Project | Relation → Projects DB | Which project | Yes |
| Procore Commitment | Text | Procore commitment number | Auto |
| Procore Invoice ID | Text | Procore requisition ID | Auto |
| QBO Bill ID | Text | QBO bill record ID | Auto |
| QBO Invoice ID | Text | Customer invoice ID in QBO | Auto |
| Status | Select | See status options below | Yes |
| Match Confidence | Select | HIGH / MEDIUM / LOW / MANUAL | Auto |
| PM Assigned | Person | Responsible project manager | Yes |
| Duplicate Of | Relation → Invoice Tracker | Links to original if flagged | Auto |
| Entry Source | Select | Email / Procore / Manual / SmoothX | Auto |
| Created By | Text | System or person who created | Auto |
| Approval Date | Date | When PM approved | Auto |
| Invoiced Date | Date | When sent to customer | Auto |
| Payment Due | Date | Net terms deadline | Calc |
| Payment Received | Date | When customer paid | Auto |
| Follow-Up Count | Number | Reminders sent to customer | Auto |
| Days Outstanding | Formula | `dateBetween(now(), prop("Invoice Date"), "days")` | Auto |
| Notes | Rich Text | PM notes, AI matching details | Optional |

### Status Options

| Status | Color | Meaning |
|--------|-------|---------|
| Received | Blue | Invoice captured, being processed |
| Duplicate Detected | Red | Flagged as potential duplicate — BLOCKED |
| Matched - Pending Approval | Yellow | Matched to Procore commitment, awaiting PM |
| Needs Manual Match | Orange | AI couldn't match, PM must assign commitment |
| Approved | Green | PM approved, ready to invoice customer |
| Rejected | Red | PM rejected with reason |
| Invoiced to Customer | Purple | Customer invoice generated and sent |
| Follow-Up Sent | Yellow | Payment reminder sent |
| Paid | Green | Payment received and confirmed |
| Overdue - Escalated | Red | Past due, escalated to finance |

### Views

1. **PM Dashboard** — Grouped by PM, filtered to their pending items
   - Filter: PM Assigned = @me AND Status NOT IN (Paid, Rejected, Duplicate Detected)
   - Sort: Status, then Invoice Date ascending

2. **Duplicate Alert Board** — Kanban by status, filtered to duplicates
   - Filter: Status = "Duplicate Detected"
   - Sort: Invoice Date descending

3. **Cash Flow Board** — Table grouped by Customer
   - Filter: Status IN (Invoiced to Customer, Follow-Up Sent, Overdue - Escalated)
   - Sort: Payment Due ascending

4. **Weekly Processing Queue** — Table of new invoices
   - Filter: Status IN (Received, Matched - Pending Approval, Needs Manual Match)
   - Sort: Invoice Date ascending

---

## Database 2: Projects

| Property Name | Type | Description |
|--------------|------|-------------|
| Project Name | Title | Project identifier |
| Procore Project ID | Text | Links to Procore |
| Customer | Relation → Customers DB | Project owner |
| PM Assigned | Person | Project manager |
| Status | Select | Bidding / Active / Punch List / Closed Out |
| Total Contract | Number (USD) | Original contract value |
| Approved Changes | Rollup | Sum from Change Orders |
| Revised Contract | Formula | Total Contract + Approved Changes |
| Billed to Date | Rollup | Sum of invoiced amounts |
| Paid to Date | Rollup | Sum of payments received |
| Remaining | Formula | Revised Contract - Billed to Date |
| Invoices | Relation → Invoice Tracker | All related invoices |
| Procore URL | URL | Direct link to Procore project |

---

## Database 3: Vendors

| Property Name | Type | Description |
|--------------|------|-------------|
| Vendor Name | Title | Company name |
| Normalized Name | Text | Lowercase, stripped for dedup matching |
| Procore Vendor ID | Text | Procore reference |
| QBO Vendor ID | Text | QBO reference |
| SmoothX Vendor ID | Text | SmoothX reference (if applicable) |
| Contact Email | Email | Primary contact |
| Contact Phone | Phone | Primary phone |
| W-9 on File | Checkbox | Compliance flag |
| Insurance Expiry | Date | COI expiration |
| Projects | Relation → Projects DB | All projects |
| Total Paid YTD | Rollup | Year-to-date payments |
| Active Commitments | Number | Open commitment count |
| Last Payment | Date | Most recent payment date |
| Duplicate Payment History | Checkbox | Ever had a duplicate payment |

---

## Database 4: Customers

| Property Name | Type | Description |
|--------------|------|-------------|
| Customer Name | Title | Customer/owner name |
| QBO Customer ID | Text | QBO reference |
| Contact Email | Email | Billing contact |
| Contact Phone | Phone | Primary phone |
| Payment Terms | Select | Net 30 / Net 45 / Net 60 |
| Projects | Relation → Projects DB | All projects |
| Outstanding Balance | Rollup | Unpaid invoice total |
| Average Days to Pay | Formula | Historical payment speed |

---

## Database 5: Audit Log

| Property Name | Type | Description |
|--------------|------|-------------|
| Timestamp | Date (with time) | When action occurred |
| Action | Select | Created / Matched / Approved / Paid / Flagged / Duplicate Blocked |
| Invoice | Relation → Invoice Tracker | Related invoice |
| Performed By | Text | System, PM name, or "AI Engine" |
| Details | Rich Text | Full action details |
| System | Select | n8n / QBO / Procore / Manual / AI |

---

## Database 6: Payments

| Property Name | Type | Description |
|--------------|------|-------------|
| Payment Reference | Title | Check # or ACH reference |
| Invoice | Relation → Invoice Tracker | Which invoice(s) |
| Vendor | Relation → Vendors DB | Payee |
| Amount | Number (USD) | Payment amount |
| Payment Date | Date | Date paid |
| Method | Select | Check / ACH / Wire |
| QBO Payment ID | Text | QBO transaction reference |
| Cleared | Checkbox | Bank reconciliation flag |
| Potential Duplicate | Checkbox | Auto-flagged by dedup engine |

---

## Notion API Integration Token Setup

### Step 1: Create Internal Integration
1. Go to https://www.notion.so/my-integrations
2. Click "New integration"
3. Name: "Frontline Payment Automation"
4. Select workspace: Frontline Holdings
5. Capabilities: Read content, Update content, Insert content
6. Copy the Internal Integration Token (starts with `ntn_`)

### Step 2: Share Databases with Integration
For EACH database created above:
1. Open the database page in Notion
2. Click the "..." menu → Connections
3. Search for "Frontline Payment Automation"
4. Click to connect

### Step 3: Configure n8n
1. In n8n, add Notion credentials:
   - Type: Internal Integration Token
   - Token: paste the `ntn_` token
2. Set environment variables:
   ```
   NOTION_INVOICE_TRACKER_DB_ID=<database_id>
   NOTION_PROJECTS_DB_ID=<database_id>
   NOTION_VENDORS_DB_ID=<database_id>
   NOTION_CUSTOMERS_DB_ID=<database_id>
   NOTION_AUDIT_LOG_DB_ID=<database_id>
   NOTION_PAYMENTS_DB_ID=<database_id>
   ```

### Step 4: API Version
Use Notion API version `2022-06-28` (stable) or `2025-09-03` (latest with data sources support).

**Rate Limits:** 3 requests/second average. Throttle to 1 request per 333ms for safety.

---

## Cross-Reference Architecture

```
Procore Project ID  <--> Notion Project (stored in "Procore Project ID" property)
                              |
                              | (relation)
                              v
                    Notion Invoice Entry
                              |
                    +---------+---------+
                    |                   |
                    v                   v
         "Procore Commitment"    "QBO Bill ID" / "QBO Invoice ID"
         (text property)         (text properties)
                    |                   |
                    v                   v
         Procore Commitment      QBO Bill / Invoice Record
```

This ensures **every Notion record contains the foreign keys for both Procore and QBO**, enabling full cross-system traceability and reconciliation.
